<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>ç¦å²¡æ—…è¡Œ</title>

  <!-- PWA / iPhone -->
  <link rel="manifest" href="/manifest.json" />
  <link rel="apple-touch-icon" href="/icons/icon-180.png" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="ç¦å²¡æ—…è¡Œ" />
  <meta name="theme-color" content="#b91c1c" />

  <!-- Tailwind / React / Babel (UMD) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <style>
    /* Map 3æŠãƒ¢ãƒ¼ãƒ€ãƒ«ï¼ˆå…±é€šï¼‰ */
    #mapDialog{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.45);z-index:1000}
    #mapDialog .panel{width:min(92%,380px);background:#fff;border-radius:16px;padding:16px;box-shadow:0 10px 25px rgba(0,0,0,.18);max-height:80vh;display:flex;flex-direction:column}
    #mapDialog .head{font-size:15px;font-weight:600;margin-bottom:8px}
    #mapDialog .place{font-size:16px;font-weight:700;margin-bottom:12px;word-break:keep-all}
    #mapDialog .btn{width:100%;border:none;border-radius:10px;padding:12px 14px;font-size:15px;margin-top:8px}
    #mapDialog .google{background:#4285F4;color:#fff}
    #mapDialog .apple{background:#111;color:#fff}
    #mapDialog .cancel{background:#e5e7eb;color:#111}

    /* Flight ãƒ¢ãƒ¼ãƒ€ãƒ«ï¼šãƒšãƒ¼ã‚¸èƒŒé¢ã¯å›ºå®šã€å†…å®¹ã ã‘ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ« */
    #flightSheet{position:fixed;inset:0;display:none;align-items:flex-end;justify-content:center;background:rgba(0,0,0,.45);z-index:1000}
    #flightSheet .sheet{width:100%;max-width:680px;background:#fff;border-radius:16px 16px 0 0;box-shadow:0 -10px 25px rgba(0,0,0,.18);display:flex;flex-direction:column;max-height:85vh;
      will-change: transform; transition: transform .25s ease;}
    #flightSheet .sheet.dragging{transition:none}
    #flightSheet .bar{width:44px;height:5px;background:#e5e7eb;border-radius:9999px;margin:10px auto 6px}
    #flightSheet .body{overflow:auto;padding:8px 16px 16px}
    /* ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³ */
    details{background:#fff;border:1px solid #e5e7eb;border-radius:12px;margin:12px 0}
    summary{cursor:pointer;list-style:none;padding:14px 16px;font-weight:700}
    summary::-webkit-details-marker{display:none}
    .card{padding:14px 16px;border-top:1px solid #f1f5f9}
  </style>
</head>
<body class="bg-gray-100 text-gray-900">

  <!-- Map 3æŠãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div id="mapDialog" onclick="closeDialog()">
    <div class="panel" onclick="event.stopPropagation()">
      <div class="head">åœ°å›³ã‚’é–‹ã</div>
      <div id="mapPlace" class="place">å ´æ‰€å</div>
      <button class="btn google" onclick="goGoogle()">Google Map</button>
      <button class="btn apple"  onclick="goApple()">Apple Map</button>
      <button class="btn cancel" onclick="closeDialog()">æˆ»ã‚‹</button>
    </div>
  </div>

  <!-- Flight ãƒ¢ãƒ¼ãƒ€ãƒ«ï¼ˆè¡Œãï¼å¸°ã‚Šï¼‰ -->
  <div id="flightSheet" onclick="closeFlight()">
    <!-- â–¼ã‚·ãƒ¼ãƒˆæœ¬ä½“ã« id ä»˜ä¸ï¼ˆãƒ‰ãƒ©ãƒƒã‚°å¯¾è±¡ï¼‰ -->
    <div id="flightPanel" class="sheet" onclick="event.stopPropagation()">
      <div class="bar"></div>
      <div class="body" id="flightBody"></div>
      <button class="w-full p-4 text-center font-semibold bg-gray-100" onclick="closeFlight()">é–‰ã˜ã‚‹</button>
    </div>
  </div>

  <div id="root"></div>

  <script type="text/babel">
  const { useEffect } = React;

  /* ===== ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆå®šæ•°ï¼ˆã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ï¼‰ ===== */
  const TIME_COL = 72;   // px
  const RAIL_COL = 20;   // pxï¼ˆä¸­å¤®ã«ãƒ¬ãƒ¼ãƒ«ã€ä¸¸ã®ç›´å¾„12pxï¼‰
  const GRID_GAP = 16;   // åˆ—é–“
  const DOT_DIAM = 12;   // ä¸¸ã®ç›´å¾„
  const RAIL_OFFSET = -1; // ä¸¸ä¸­å¿ƒã¨ç·šã®å¾®èª¿æ•´ï¼ˆ-2ã€œ+2ã§èª¿æ•´å¯èƒ½ï¼‰
  const RAIL_LEFT_PX = TIME_COL + GRID_GAP + (RAIL_COL / 2) + RAIL_OFFSET;

  /* ===== Map ãƒªãƒ³ã‚¯ç”Ÿæˆï¼ˆæ–¹é‡ï¼‰ ===== */
  const openNew = url => window.open(url, "_blank", "noopener");
  const buildAppleUrl = (place) => {
    if (place.lat != null && place.lon != null) {
      return `https://maps.apple.com/?ll=${place.lat},${place.lon}`;
    }
    return `https://maps.apple.com/?q=${encodeURIComponent(place.name)}`;
  };

  /* ===== ãƒ¢ãƒ¼ãƒ€ãƒ«ï¼ˆMapï¼‰ ===== */
  let currentPlace = null;
  window.openMapDialog = (place) => {
    currentPlace = place;
    document.getElementById("mapPlace").innerText = place.name;
    document.getElementById("mapDialog").style.display = "flex";
  };
  window.closeDialog = () => {
    document.getElementById("mapDialog").style.display = "none";
    currentPlace = null;
  };
  window.goGoogle = () => { if (currentPlace?.gUrl) openNew(currentPlace.gUrl); closeDialog(); };
  window.goApple  = () => { if (currentPlace) openNew(buildAppleUrl(currentPlace)); closeDialog(); };

  /* ===== ãƒ¢ãƒ¼ãƒ€ãƒ«ï¼ˆFlightï¼‰ ===== */
  const HND_MAP = "https://tokyo-haneda.com/floor/index.html";
  const NGO_MAP = "https://www.centrair.jp/map/index.html";
  const SFJ_CHECKIN = "https://www.starflyer.jp/checkin/boarding/vender.html";

  let flightSheetOpen = false;

  // --- ã‚¹ãƒ¯ã‚¤ãƒ—ã§é–‰ã˜ã‚‹ç”¨ ---------------
  let startY = 0, currentY = 0, dragging = false, panelEl = null;
  const DRAG_CLOSE_THRESHOLD = 120; // ã“ã‚Œä»¥ä¸Šå¼•ã„ãŸã‚‰é–‰ã˜ã‚‹

  const onDragStart = (y) => {
    dragging = true;
    startY = y;
    currentY = y;
    panelEl.classList.add('dragging');
  };
  const onDragMove = (y) => {
    if (!dragging) return;
    currentY = y;
    const delta = Math.max(0, currentY - startY);
    panelEl.style.transform = `translateY(${delta}px)`;
  };
  const onDragEnd = () => {
    if (!dragging) return;
    dragging = false;
    const delta = Math.max(0, currentY - startY);
    panelEl.classList.remove('dragging');
    if (delta > DRAG_CLOSE_THRESHOLD) {
      closeFlight();
    } else {
      panelEl.style.transform = 'translateY(0)';
    }
  };
  const attachDragHandlers = () => {
    // touch
    panelEl.addEventListener('touchstart', (e)=> onDragStart(e.touches[0].clientY), {passive:true});
    panelEl.addEventListener('touchmove',  (e)=> onDragMove(e.touches[0].clientY), {passive:true});
    panelEl.addEventListener('touchend',   onDragEnd);
    // mouseï¼ˆPCã§ã‚‚æ“ä½œå¯ï¼‰
    panelEl.addEventListener('mousedown', (e)=> onDragStart(e.clientY));
    window.addEventListener('mousemove',  (e)=> onDragMove(e.clientY));
    window.addEventListener('mouseup',    onDragEnd);
  };
  // -------------------------------------

  window.openFlight = (html) => {
    document.body.style.overflow = "hidden";
    document.getElementById("flightBody").innerHTML = html;
    const sheet = document.getElementById("flightSheet");
    panelEl = document.getElementById("flightPanel");
    panelEl.style.transform = 'translateY(0)'; // åˆæœŸä½ç½®
    sheet.style.display = "flex";
    flightSheetOpen = true;
  };
  window.closeFlight = () => {
    const sheet = document.getElementById("flightSheet");
    const body = document.getElementById("flightBody");
    sheet.style.display = "none";
    body.innerHTML = "";
    document.body.style.overflow = "";
    flightSheetOpen = false;
    if (panelEl) panelEl.style.transform = 'translateY(0)'; // ãƒªã‚»ãƒƒãƒˆ
  };

  /* ===== å€™è£œï¼ˆå„ã‚¹ãƒãƒƒãƒˆï¼‰: name / gUrl / lat / lon ===== */
  const PLACES = {
    hotel: {
      name: "HOTEL ç²‹ - sui - HARUYOSHI",
      gUrl: "https://maps.app.goo.gl/SzYhBhZ6TuZbtRbv6",
      lat: null, lon: null,
    },
    exbar: { name: "EXBAR TOKYO plus åšå¤š", gUrl: "https://maps.app.goo.gl/xxxxxxxx", lat: null, lon: null },
    maruya:{ name: "æµ·é®®å±…é…’å±‹ ã¾ã‚‹å®¶ è¥¿ä¸­æ´²", gUrl: "https://maps.app.goo.gl/xxxxxxxx", lat: null, lon: null },
    ohori:{ name:"å¤§æ¿ å…¬åœ’", gUrl:"https://maps.app.goo.gl/xxxxxxxx", lat:null, lon:null },
    maizuru:{ name:"ç¦å²¡åŸè·¡ï¼ˆèˆé¶´å…¬åœ’ï¼‰", gUrl:"https://maps.app.goo.gl/xxxxxxxx", lat:null, lon:null },
    port:{ name:"åšå¤šãƒãƒ¼ãƒˆã‚¿ãƒ¯ãƒ¼", gUrl:"https://maps.app.goo.gl/xxxxxxxx", lat:null, lon:null },
    kushida:{ name:"æ«›ç”°ç¥ç¤¾", gUrl:"https://maps.app.goo.gl/xxxxxxxx", lat:null, lon:null },
    joutenji:{ name:"æ‰¿å¤©å¯ºé€šã‚Š", gUrl:"https://maps.app.goo.gl/xxxxxxxx", lat:null, lon:null },
  };

  const day2_3LunchCandidates = [
    { name: "å…ƒç¥– åšå¤šã‚ã‚“ãŸã„é‡", gUrl:"https://maps.app.goo.gl/xxxxxxxx", lat:null, lon:null },
    { name: "åšå¤šã‚·ãƒ¼ãƒ•ãƒ¼ãƒ‰ ã†ãŠç”°", gUrl:"https://maps.app.goo.gl/xxxxxxxx", lat:null, lon:null },
    { name: "é­šãƒˆè‚´ ã„ã¨ãŠã‹ã—ï¼ˆæ˜¥å‰ï¼‰", gUrl:"https://maps.app.goo.gl/xxxxxxxx", lat:null, lon:null },
    { name: "ã²ã—ã‚€ã‚‰ï¼ˆæ˜¥å‰ï¼‰", gUrl:"https://maps.app.goo.gl/xxxxxxxx", lat:null, lon:null },
    { name: "å¤§åœ°ã®ã†ã©ã‚“ åšå¤šé§…ã¡ã‹ã¦ã‚“ï¼ˆæœæ—¥ãƒ“ãƒ«B2ï¼‰", gUrl:"https://maps.app.goo.gl/xxxxxxxx", lat:null, lon:null },
  ];
  const airportLunchCandidates = [
    { name: "ç«¹ä¹ƒå±‹ ç¦å²¡ç©ºæ¸¯åº—", gUrl:"https://maps.app.goo.gl/xxxxxxxx", lat:null, lon:null },
    { name: "ãƒ©ãƒ¼ãƒ¡ãƒ³æ»‘èµ°è·¯ï¼ˆãƒ•ãƒ¼ãƒ‰ãƒ›ãƒ¼ãƒ«ï¼‰", gUrl:"https://maps.app.goo.gl/xxxxxxxx", lat:null, lon:null },
    { name: "å› å¹¡ã†ã©ã‚“ï¼ˆç¦å²¡ç©ºæ¸¯ï¼‰", gUrl:"https://maps.app.goo.gl/xxxxxxxx", lat:null, lon:null },
    { name: "ã†ã¾ã‚„ ç¦å²¡ç©ºæ¸¯åº—", gUrl:"https://maps.app.goo.gl/xxxxxxxx", lat:null, lon:null },
    { name: "B.B.Quisineï¼ˆå›½å†…ç·š3Fï¼‰", gUrl:"https://maps.app.goo.gl/xxxxxxxx", lat:null, lon:null },
  ];

  /* ===== ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ ===== */
  const timeline = [
    {
      day: "Day 1 (9/19 é‡‘)",
      events: [
        { time:"12:10", title:"ğŸ›« åå¤å±‹ç™ºï¼ˆé£›è¡Œæ©Ÿï¼‰", detail:"12:10 â†’ 13:35", action:"outbound" },
        { time:"12:15", title:"ğŸ›« æ±äº¬ç™ºï¼ˆé£›è¡Œæ©Ÿï¼‰",   detail:"12:15 â†’ 14:10", action:"outbound" },
        { time:"15:00", title:"ğŸ´ ãŠæ˜¼", detail:"ç©ºæ¸¯å†…ã®å€™è£œï¼ˆ10äººä»¥ä¸ŠOKï¼‰", candidates:airportLunchCandidates },
        { time:"16:00", title:"ğŸ¨ ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³", detail: PLACES.hotel.name, place: PLACES.hotel },
        { time:"16:30", title:"ğŸš´ è‡ªè»¢è»Šè¦³å…‰", detail:"å¤§æ¿ å…¬åœ’ / ç¦å²¡åŸè·¡ / åšå¤šãƒãƒ¼ãƒˆã‚¿ãƒ¯ãƒ¼ / æ«›ç”°ç¥ç¤¾ / æ‰¿å¤©å¯ºé€šã‚Š ãªã©",
          candidates: [
            { name: PLACES.ohori.name, gUrl: PLACES.ohori.gUrl, lat:PLACES.ohori.lat, lon:PLACES.ohori.lon },
            { name: PLACES.maizuru.name, gUrl: PLACES.maizuru.gUrl, lat:PLACES.maizuru.lat, lon:PLACES.maizuru.lon },
            { name: PLACES.port.name, gUrl: PLACES.port.gUrl, lat:PLACES.port.lat, lon:PLACES.port.lon },
            { name: PLACES.kushida.name, gUrl: PLACES.kushida.gUrl, lat:PLACES.kushida.lat, lon:PLACES.kushida.lon },
            { name: PLACES.joutenji.name, gUrl: PLACES.joutenji.gUrl, lat:PLACES.joutenji.lat, lon:PLACES.joutenji.lon },
          ] },
        { time:"20:30", title:"ğŸ² å¤œã”é£¯", detail:"å…ƒç¥– ã‚‚ã¤é‹ æ¥½å¤©åœ° å¤©ç¥æœ¬åº—ï¼ˆã‚¢ã‚¯ãƒ­ã‚¹ç¦å²¡ B2Fï¼‰",
          place:{ name:"å…ƒç¥– ã‚‚ã¤é‹ æ¥½å¤©åœ° å¤©ç¥æœ¬åº—", gUrl:"https://maps.app.goo.gl/xxxxxxxx", lat:null, lon:null } },
        { time:"22:00", title:"ğŸ•’ è‡ªç”±æ™‚é–“" },
      ]
    },
    {
      day: "Day 2 (9/20 åœŸ)",
      events: [
        { time:"12:00", title:"ğŸ´ ãŠæ˜¼ï¼ˆå€™è£œï¼‰", detail:"å€™è£œã‹ã‚‰é¸æŠ", candidates:day2_3LunchCandidates },
        { time:"14:00", title:"ğŸ¯ ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£", detail: PLACES.exbar.name, place: PLACES.exbar },
        { time:"18:00", title:"ğŸº å¤œã”é£¯", detail: PLACES.maruya.name, place: PLACES.maruya },
        { time:"20:00", title:"ğŸ¸ 2ä»¶ç›®ï¼ˆæœªå®šï¼‰" },
        { time:"22:00", title:"ğŸ•’ è‡ªç”±æ™‚é–“" },
      ]
    },
    {
      day: "Day 3 (9/21 æ—¥)",
      events: [
        { time:"12:00", title:"ğŸ´ ãŠæ˜¼ï¼ˆå€™è£œï¼‰", detail:"å€™è£œã‹ã‚‰é¸æŠ", candidates: day2_3LunchCandidates },
        { time:"13:00", title:"ğŸ›ï¸ ç©ºæ¸¯ã‚·ãƒ§ãƒƒãƒ”ãƒ³ã‚°ï¼ˆãŠåœŸç”£ï¼‰",
          candidates: [
            { name:"ANA FESTAï¼ˆå›½å†…ç·šï¼‰", gUrl:"https://maps.app.goo.gl/xxxxxxxx", lat:null, lon:null },
            { name:"åšå¤šéŠ˜å“è”µ", gUrl:"https://maps.app.goo.gl/xxxxxxxx", lat:null, lon:null },
            { name:"ãã‚‰ã‚‚ãƒ¼ã‚‹å•†åº—", gUrl:"https://maps.app.goo.gl/xxxxxxxx", lat:null, lon:null },
            { name:"ç¦å¤ªéƒï¼ˆæ˜å¤ªå­ï¼‰", gUrl:"https://maps.app.goo.gl/xxxxxxxx", lat:null, lon:null },
            { name:"æ±é›²å ‚ï¼ˆã«ã‚ã‹ã›ã‚“ãºã„ï¼‰", gUrl:"https://maps.app.goo.gl/xxxxxxxx", lat:null, lon:null },
          ] },
        { time:"14:15", title:"ğŸ›¬ æ±äº¬çµ„ å¸°ã‚Šï¼ˆé£›è¡Œæ©Ÿï¼‰", detail:"14:15 â†’ 16:05", action:"inbound" },
        { time:"14:50", title:"ğŸ›¬ åå¤å±‹çµ„ å¸°ã‚Šï¼ˆé£›è¡Œæ©Ÿï¼‰", detail:"14:50 â†’ 16:40", action:"inbound" },
      ]
    }
  ];

  /* ===== ä¾¿æƒ…å ±ï¼ˆãƒ¢ãƒ¼ãƒ€ãƒ«ç”¨ HTML ã‚’è¿”ã™ï¼‰ ===== */
  const flightHtml = (kind="outbound") => {
    const head =
      `<div class="text-lg font-bold mb-2">${kind==="outbound"?"è¡Œãï¼ˆOUTBOUNDï¼‰":"å¸°ã‚Šï¼ˆINBOUNDï¼‰"}</div>
       <div class="flex gap-2 mb-3">
         <a class="px-3 py-2 rounded-lg border" href="${HND_MAP}" target="_blank" rel="noopener">ç¾½ç”°ãƒ•ãƒ­ã‚¢ãƒãƒƒãƒ—</a>
         <a class="px-3 py-2 rounded-lg border" href="${NGO_MAP}" target="_blank" rel="noopener">ã‚»ãƒ³ãƒˆãƒ¬ã‚¢ãƒ•ãƒ­ã‚¢ãƒãƒƒãƒ—</a>
       </div>
       <a class="inline-block px-4 py-3 rounded-lg bg-black text-white font-semibold mb-2" href="${SFJ_CHECKIN}" target="_blank" rel="noopener">ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³æ–¹æ³•</a>
       <p class="text-xs text-gray-600 mb-2">â€» é›†åˆã¯å‡ºç™ºã®<b>60åˆ†å‰</b>ã€‚<b>äºˆç´„ç•ªå·ãƒ»ç¢ºèªç•ªå·</b>ã‚’æº–å‚™ã—ã¦ãŠãã€‚</p>`;

    const rows = (title, data) => `
      <details>
        <summary>${title}</summary>
        <div class="card text-sm leading-7">
          <div><b>äºˆç´„ç•ªå·</b>ï¼š${data.reserve}</div>
          <div><b>ç¢ºèªç•ªå·</b>ï¼š${data.confirm}</div>
          <div><b>æ­ä¹—è€…</b>ï¼š${data.names}</div>
          <div><b>ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³å ´æ‰€</b>ï¼š${data.checkin}</div>
        </div>
      </details>`;

    if (kind==="outbound") {
      return head
      + rows("æ±äº¬çµ„ï¼ˆä¾¿åï¼šSFJ047ï¼‰", {reserve:"3101", confirm:"482-743-569", names:"ç”°ä¸­ã€æ–°äº•", checkin:"ç¬¬1ã‚¿ãƒ¼ãƒŸãƒŠãƒ«2éš SFJã‚«ã‚¦ãƒ³ã‚¿ãƒ¼"})
      + rows("åå¤å±‹çµ„1ï¼ˆä¾¿åï¼šSFJ063ï¼‰", {reserve:"3101", confirm:"607-330-326", names:"æµ…é‡ã€å®®è…°ã€ä¸Šå €", checkin:"æ—…å®¢ã‚¿ãƒ¼ãƒŸãƒŠãƒ«3F å›½å†…ç·š ANAã‚«ã‚¦ãƒ³ã‚¿ãƒ¼"})
      + rows("åå¤å±‹çµ„2ï¼ˆä¾¿åï¼šSFJ063ï¼‰", {reserve:"3104", confirm:"197-714-403", names:"é½Šè—¤ã€æ£®ã€é•·æ²¼ã€é‡ç”°ã€å‰ç”°", checkin:"æ—…å®¢ã‚¿ãƒ¼ãƒŸãƒŠãƒ«3F å›½å†…ç·š ANAã‚«ã‚¦ãƒ³ã‚¿ãƒ¼"});
    }
    return head
      + rows("æ±äº¬çµ„ï¼ˆä¾¿åï¼šSFJ048ï¼‰", {reserve:"3109", confirm:"763-117-264", names:"æ–°äº•ã€ç”°ä¸­", checkin:"ç¬¬1ã‚¿ãƒ¼ãƒŸãƒŠãƒ«2éš SFJã‚«ã‚¦ãƒ³ã‚¿ãƒ¼"})
      + rows("åå¤å±‹çµ„1ï¼ˆä¾¿åï¼šSFJ062ï¼‰", {reserve:"3102", confirm:"482-743-329", names:"æµ…é‡ã€å®®è…°ã€ä¸Šå €", checkin:"æ—…å®¢ã‚¿ãƒ¼ãƒŸãƒŠãƒ«3F å›½å†…ç·š ANAã‚«ã‚¦ãƒ³ã‚¿ãƒ¼"})
      + rows("åå¤å±‹çµ„2ï¼ˆä¾¿åï¼šSFJ062ï¼‰", {reserve:"3105", confirm:"825-237-635", names:"é½Šè—¤ã€æ£®ã€é•·æ²¼ã€é‡ç”°ã€å‰ç”°", checkin:"æ—…å®¢ã‚¿ãƒ¼ãƒŸãƒŠãƒ«3F å›½å†…ç·š ANAã‚«ã‚¦ãƒ³ã‚¿ãƒ¼"});
  };

  /* ===== UI ===== */
  const Pill = ({children,onClick,variant="default"})=>{
    const base = "inline-block px-4 py-2 rounded-full text-sm";
    const cls  = variant==="ghost"
      ? base+" border bg-white hover:bg-gray-50"
      : base+" bg-gray-100 hover:bg-gray-200 text-gray-800";
    return <button onClick={onClick} className={cls}>{children}</button>;
  };

  function EventRow({ time, title, detail, place, candidates, action }) {
    const openAction = () => {
      if (action==="outbound") return openFlight(flightHtml("outbound"));
      if (action==="inbound")  return openFlight(flightHtml("inbound"));
    };

    return (
      <div
        className="grid items-center mb-8"
        style={{ gridTemplateColumns: `${TIME_COL}px ${RAIL_COL}px 1fr`, columnGap: `${GRID_GAP}px` }}
      >
        <div className="text-right font-bold text-gray-800 tabular-nums">{time}</div>
        <div className="relative flex items-center justify-center">
          <div className="w-[12px] h-[12px] bg-blue-600 rounded-full"></div>
        </div>
        <div className="bg-white rounded-2xl shadow p-4">
          <div className="font-semibold text-gray-900 text-lg">{title}</div>
          {detail && <div className="text-sm text-gray-600 mt-1">{detail}</div>}
          {action && (<div className="mt-3"><Pill variant="ghost" onClick={openAction}>è©³ç´°ã‚’é–‹ã</Pill></div>)}
          {!action && place && (
            <div className="mt-3"><Pill onClick={()=>openMapDialog(place)}>åœ°å›³ã‚’é–‹ã</Pill></div>
          )}
          {candidates && (
            <div className="mt-3">
              <div className="text-xs text-gray-500 mb-2">å€™è£œï¼ˆã‚¿ãƒƒãƒ—ã§ãƒãƒƒãƒ—ã‚’é¸æŠï¼‰</div>
              <div className="flex flex-wrap gap-2">
                {candidates.map((s,i)=>(<Pill key={i} onClick={()=>openMapDialog(s)}>{s.name}</Pill>))}
              </div>
            </div>
          )}
        </div>
      </div>
    );
  }

  function DaySection({ day, events }) {
    return (
      <div className="mb-12">
        <h2 className="text-xl font-semibold mb-6 border-b pb-2">{day}</h2>
        <div className="relative">
          <div className="absolute bg-gray-300" style={{ left:`${RAIL_LEFT_PX}px`, top:10, bottom:10, width:2, borderRadius:9999 }}></div>
          <div>{events.map((ev,i)=>(<EventRow key={i} {...ev} />))}</div>
        </div>
      </div>
    );
  }

  function App(){
    useEffect(()=>{
      if("serviceWorker" in navigator){ navigator.serviceWorker.register("/sw.js").catch(()=>{}); }
      // ãƒ‰ãƒ©ãƒƒã‚°ãƒãƒ³ãƒ‰ãƒ©ã®åˆæœŸåŒ–
      const el = document.getElementById('flightPanel');
      if (el) { panelEl = el; attachDragHandlers(); }
    },[]);
    return (
      <div className="p-6 md:p-8 w-full min-h-screen flex flex-col items-center"
           style={{ paddingTop: 'calc(env(safe-area-inset-top, 0px) + 16px)' }}>
        <h1 className="text-3xl font-bold tracking-wide mt-2">ç¦å²¡æ—…è¡Œ</h1>
        <p className="text-sm text-gray-600 mb-6">æœŸé–“ï¼š2025.09.19 - 2025.09.21</p>
        <div className="w-full max-w-4xl">
          {timeline.map((d,idx)=>(<DaySection key={idx} {...d} />))}
        </div>
        <footer className="mt-2 text-xs text-gray-500 text-center pb-10">
          ğŸ“Œ iPhoneã§ãƒ›ãƒ¼ãƒ ç”»é¢ã«è¿½åŠ ï¼šSafariã§é–‹ã â†’ å…±æœ‰ï¼ˆâ–¡ã«â†‘ï¼‰â†’ <b>ãƒ›ãƒ¼ãƒ ç”»é¢ã«è¿½åŠ </b>
        </footer>
      </div>
    );
  }

  ReactDOM.createRoot(document.getElementById("root")).render(<App />);
  </script>
</body>
</html>
